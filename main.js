(()=>{"use strict";class t{constructor(t,e,s){this._name=t.title,this._link=t.link,this._cardSelector=e,this._handleCardClick=s}_cloneCard(){return document.querySelector(this._cardSelector).content.querySelector(".cards__item").cloneNode(!0)}generate(){return this._cardItem=this._cloneCard(),this._cardImage=this._cardItem.querySelector(".cards__image"),this._cardImage.src=this._link,this._cardItem.querySelector(".cards__name").textContent=this._name,this._cardImage.alt=this._name,this._cardLike=this._cardItem.querySelector(".cards__like"),this._cardDelete=this._cardItem.querySelector(".cards__delete"),this._setEventListeners(),this._cardItem}_handleLikeCard(){this._cardLike.classList.toggle("cards__like_active")}_deleteCard(){this._cardItem.remove()}_setEventListeners(){this._cardLike.addEventListener("click",(()=>{this._handleLikeCard()})),this._cardDelete.addEventListener("click",(()=>{this._deleteCard()})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}}class e{constructor(t,e){this._formElement=t.formElement,this._inputElement=t.inputElement,this._formButton=t.formButton,this._inactiveButtonClass=t.inactiveButtonClass,this._inputInvalidClass=t.inputInvalidClass,this._errorClass=t.errorClass,this._form=e}enableValidation(){this._form.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputElement)),this._submitButton=this._form.querySelector(this._formButton),this._toggleButtonState(this._inputList),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._isValid(t),this._toggleButtonState()}))}))}_isValid(t){this._errorElement=this._form.querySelector(`.${t.id}-input-error`),t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.setAttribute("disabled",!0)):(this._submitButton.removeAttribute("disabled"),this._submitButton.classList.remove(this._inactiveButtonClass))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}_showInputError(t,e){t.classList.add(this._inputInvalidClass),this._errorElement.textContent=e,this._errorElement.classList.add(this._errorClass)}_hideInputError(t){t.classList.remove(this._inputInvalidClass),this._errorElement=this._form.querySelector(`.${t.id}-input-error`),this._errorElement.classList.remove(this._errorClass),this._errorElement.textContent=""}}class s{constructor(t){this._popupSelector=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popupSelector.addEventListener("mousedown",(t=>{(t.target.classList.contains("popup")||t.target.classList.contains("popup__close-button"))&&this.close()}))}}class i extends s{constructor({popupSelector:t,handleAddFormSubmit:e}){super(t),this._handleAddFormSubmit=e,this._popupForm=this._popupSelector.querySelector(".popup__form")}_getInputValues(){return this._inputList=this._popupSelector.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((t=>this._formValues[t.name]=t.value)),this._formValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(t=>{t.preventDefault();const e=this._getInputValues();this._handleAddFormSubmit(e)}))}close(){super.close(),this._popupForm.reset()}}const r=document.querySelector(".profile__edit-button"),o=document.querySelector(".profile__add-button"),n=document.querySelector(".popup__input_type_name"),a=document.querySelector(".popup__input_type_activity"),l={},p=new class extends s{constructor(t){super(t),this._popupPhotoName=this._popupSelector.querySelector(".popup__name"),this._popupPhotoImage=this._popupSelector.querySelector(".popup__image")}open(t,e){this._popupPhotoName.textContent=t,this._popupPhotoImage.src=e,this._popupPhotoImage.alt=t,super.open()}}(".popup_type_photo"),u=({title:e,link:s})=>new t({title:e,link:s},"#cards-item",(()=>{p.open(e,s)})).generate({title:e,link:s}),_=new class{constructor({items:t,renderer:e},s){this._renderedItems=t,this._renderer=e,this._listSelector=document.querySelector(s)}addItem(t){this._listSelector.prepend(t)}renderItems(){this._renderedItems.forEach((t=>{this._renderer(t)}))}}({items:[{title:"Самара",link:"https://images.unsplash.com/photo-1646580060894-10b1e2d9ac7d?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"},{title:"Санкт-Петербург",link:"https://images.unsplash.com/photo-1596014531797-b3f67a07a493?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80"},{title:"Калининград",link:"https://images.pexels.com/photos/8321728/pexels-photo-8321728.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940"},{title:"Карелия",link:"https://images.pexels.com/photos/8632549/pexels-photo-8632549.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940"},{title:"Алтай",link:"https://images.pexels.com/photos/7300311/pexels-photo-7300311.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260"},{title:"Байкал",link:"https://images.pexels.com/photos/8676972/pexels-photo-8676972.jpeg?auto=compress&cs=tinysrgb&dpr=3&h=750&w=1260"}],renderer:t=>{const e=u(t);_.addItem(e)}},".cards"),c=new i({popupSelector:".popup_type_add-photo",handleAddFormSubmit:t=>{_.addItem(u(t)),c.close()}}),d=new class{constructor(t){this._name=document.querySelector(t.name),this._activity=document.querySelector(t.activity)}getUserInfo(){return{userName:this._name.textContent,userActivity:this._activity.textContent}}setUserInfo({name:t,activity:e}){this._name.textContent=t,this._activity.textContent=e}}({name:".profile__name",activity:".profile__activity"}),h=new i({popupSelector:".popup_type_profile",handleAddFormSubmit:t=>{d.setUserInfo(t),h.close()}});var m;_.renderItems(),m={formElement:".popup__form",inputElement:".popup__input",formButton:".popup__button",inactiveButtonClass:"popup__button_disabled",inputInvalidClass:"popup__input-invalid",errorClass:"popup__input-error"},Array.from(document.querySelectorAll(m.formElement)).forEach((t=>{const s=new e(m,t),i=t.getAttribute("name");l[i]=s,s.enableValidation()})),p.setEventListeners(),h.setEventListeners(),c.setEventListeners(),r.addEventListener("click",(()=>{l.profile.resetValidation(),h.open(),(({userName:t,userActivity:e})=>{n.value=t,a.value=e})(d.getUserInfo())})),o.addEventListener("click",(()=>{l.addPhoto.resetValidation(),c.open()}))})();